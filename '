import { useContext } from "react";
import { QuestionContext } from "../context/QuestionContext";
import { useIsButtonActive } from "./customhooks/useActiveOrNotButton";
import type { IActiveOrNotButtonProps } from "./utilityComponents/ActiveOrNotButton";
import { ActiveOrNotButton } from "./utilityComponents/ActiveOrNotButton";
import { OneClickButton } from "./utilityComponents/OneClickButton";
import type { IOneClickButtonProps } from "./utilityComponents/OneClickButton";
import { useOneClickButton } from "./customhooks/useOneClickButton";
import { Link } from "react-router-dom";

export function ButtonTab() {
    const context = useContext(QuestionContext);
    if (!context) {
        throw new Error("Context shouldn't be null")
    }
    const { isCoding, setIsCoding, qDetailsQNextPrev } = context;
    const { prevNextQuestionsArray } = qDetailsQNextPrev
    console.log(qDetailsQNextPrev)
    const { handleMouseDown: codedrawHandleDown, handleMouseUp: codedrawHandleUp } = useOneClickButton(setIsCoding);
    const { handleMouseDown: nextHandeDown, handleMouseUp: nextHandleUp } = useOneClickButton();
    //don't need this activeButtonId bcs, we are not having 2 or more ActiveOrNotButtons to switch the "isActive" state
    const {
        activeButtonId,
        handleMouseDown: activeOrNotHandleDown,
        handleMouseUp: activeOrNotHandleUp
    } = useIsButtonActive("");

    const questionProps: IActiveOrNotButtonProps = {
        id: "question",
        name: "Question",
        isActive: true,
        color: "gray",
    }

    const nextProps: IOneClickButtonProps = {
        id: "next",
        name: ">>",
        color: "gray",
    }
    const previousProps: IOneClickButtonProps = {
        id: "previous",
        name: "<<",
        color: "gray",
    }

    const isCodingProps: IOneClickButtonProps = {
        id: "code-draw",
        name: isCoding ? "<------ DRAW-BOARD" : "CODE-SPACE ------>",
        color: "amber",

    }
    //


    return (
        <div className="flex mx-2 py-2 px-5 items-center justify-between border border-solid border-black ">
            <div className="flex gap-3">
                <ActiveOrNotButton interactionFuncs={{
                    onMouseDown: activeOrNotHandleUp,
                    onMouseUp: activeOrNotHandleUp
                }}
                    buttonProps={questionProps} />
                <div className="gap-2">
                    {prevNextQuestionsArray[0] === null ?
                        <OneClickButton
                            buttonProps={previousProps} /> :
                        <Link to={`/draw-code/${prevNextQuestionsArray[0].name}`}> {`<<`}</Link>
                    }
                    {prevNextQuestionsArray[0] === null ?
                    <OneClickButton
                        buttonProps={nextProps} /> :
                        <Link to={`/draw-code/${prevNextQuestionsArray[1].name}`}> {`>>`}</Link>
                    }
                </div>
            </div>
            <div className="ml-5 w-max">
                <OneClickButton interactionFuncs={{ onMouseDown: codedrawHandleDown, onMouseUp: codedrawHandleUp }}
                    buttonProps={isCodingProps} />

                {/* <div>CODE-SPACE ------&gt;</div> */}
            </div>
        </div>
    )
}
